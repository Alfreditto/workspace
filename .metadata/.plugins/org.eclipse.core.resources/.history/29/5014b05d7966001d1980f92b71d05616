package com.ifpvg.tema2;

import java.sql.*;

public class Ejercicio7 {
	public static void main(String[] args) {

		try {
			Class.forName("com.mysql.jdbc.Driver");
			Connection conexion = DriverManager.getConnection("jdbc:mysql://localhost/ejemplo", "root", "");
			Statement sentencia = conexion.createStatement();
			int idCliente = 103;
			ResultSet resul = sentencia.executeQuery(
					"select c.nombre, v.idventa, v.idproducto , p.descripcion, v.cantidad, (v.cantidad * p.pvp) as importe"
					+ " from clientes c join ventas v on c.id = v.idcliente join productos p on p.id = v.idproducto"
					+ " where c.id = " + idCliente 
					+ " group by c.id, v.idventa;");
			while(resul.next()) {
				
			}
		} catch (SQLException e) {
			System.out.println("Ha ocurrido una excepcion");
			System.out.println("Mensaje: " + e.getMessage());
			System.out.println("SQL Estado: " + e.getSQLState());
			System.out.println("Código de error: " + e.getErrorCode());
		} catch (ClassNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
}
